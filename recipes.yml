# Recipe definitions for Ruly
# Each recipe defines a collection of rule files to combine
# Use 'ruly import --recipe <name>' or 'ruly squash --recipe <name>' to use a specific recipe

# Global default plan (can be overridden per recipe or in user config)
plan: claude_pro

recipes:
  # WorkAxle recipes - Dynamic loading based on current task
  core:
    description: "WorkAxle development dispatcher - routes tasks to specialized subagents"
    files:
      # === WorkAxle Core ===
      - /Users/patrick/Projects/ruly/rules/workaxle/core.md
      # === Essential (minimal for routing) ===
      - /Users/patrick/Projects/ruly/rules/workaxle/core/essential/common.md
      - /Users/patrick/Projects/ruly/rules/workaxle/core/essential/development-commands.md
      # === Reference (high-level codebase understanding) ===
      - /Users/patrick/Projects/ruly/rules/workaxle/core/reference/service-overview.md
      - /Users/patrick/Projects/ruly/rules/workaxle/core/reference/technology-stack.md
      # === Dispatch Rules ===
      - /Users/patrick/Projects/ruly/rules/workaxle/core/standards/use-bug.md
      - /Users/patrick/Projects/ruly/rules/workaxle/core/standards/use-feature.md
      - /Users/patrick/Projects/ruly/rules/workaxle/core/standards/use-core-debugging.md
      - /Users/patrick/Projects/ruly/rules/workaxle/core/standards/use-comms.md
      - /Users/patrick/Projects/ruly/rules/workaxle/core/standards/use-merger.md
      - /Users/patrick/Projects/ruly/rules/workaxle/core/standards/use-dashboard.md
      - /Users/patrick/Projects/ruly/rules/workaxle/core/standards/use-pr-readiness.md
      - /Users/patrick/Projects/ruly/rules/workaxle/core/standards/use-architect.md
      - /Users/patrick/Projects/ruly/rules/workaxle/core/standards/use-reviewer.md
      # === PR Operations (orchestrator handles PR creation) ===
      - /Users/patrick/Projects/ruly/rules/github/pr/commands/create.md
      - /Users/patrick/Projects/ruly/rules/github/pr/commands/create-develop.md
      - /Users/patrick/Projects/ruly/rules/github/pr/commands/create-dual.md
      - /Users/patrick/Projects/ruly/rules/github/pr/commands/review-feedback-loop.md
      # === Context Fetching (orchestrator handles context) ===
      - /Users/patrick/Projects/ruly/rules/comms/use-context-fetcher.md
      - /Users/patrick/Projects/ruly/rules/comms/commands/refresh-context.md
    subagents:
      - name: bug
        recipe: bug
      - name: feature
        recipe: feature
      - name: context_fetcher
        recipe: context-fetcher
      - name: core_debugging
        recipe: core-debugging
      - name: comms
        recipe: comms
      - name: merger
        recipe: merger
      - name: dashboard
        recipe: dashboard
      - name: pr_readiness
        recipe: pr-readiness
      - name: architect
        recipe: architect
      - name: reviewer
        recipe: reviewer

  bug:
    description: "WorkAxle bug investigation and fixing orchestrator"
    files:
      - /Users/patrick/Projects/ruly/rules/workaxle/core.md
      # === Essential (no feature-flags, no outbox — bugs don't need these) ===
      - /Users/patrick/Projects/ruly/rules/workaxle/core/essential/common.md
      - /Users/patrick/Projects/ruly/rules/workaxle/core/essential/development-commands.md
      - /Users/patrick/Projects/ruly/rules/workaxle/core/essential/sequel-patterns.md
      - /Users/patrick/Projects/ruly/rules/workaxle/core/essential/soft-delete-pattern.md
      # === Bug Investigation ===
      - /Users/patrick/Projects/ruly/rules/workaxle/profiles/bug-investigation.md
      - /Users/patrick/Projects/ruly/rules/bug/bug-workflow.md
      - /Users/patrick/Projects/ruly/rules/bug/debugging.md
      - /Users/patrick/Projects/ruly/rules/bug/policies.md
      - /Users/patrick/Projects/ruly/rules/bug/rspec-debugging-guide.md
      - /Users/patrick/Projects/ruly/rules/bug/skills/debugging.md
      # === Dispatch Rules (moved from core) ===
      - /Users/patrick/Projects/ruly/rules/workaxle/core/standards/bug-diagnose.md
      - /Users/patrick/Projects/ruly/rules/workaxle/core/standards/bug-fix.md
      # === Commands ===
      - /Users/patrick/Projects/ruly/rules/workaxle/core/commands/diagnose.md
    subagents:
      - name: bug_diagnose
        recipe: bug-diagnose
      - name: bug_fix
        recipe: bug-fix
      - name: core_debugging
        recipe: core-debugging

  migration:
    description: "WorkAxle database migrations"
    files:
      - /Users/patrick/Projects/ruly/rules/workaxle/core.md
      - /Users/patrick/Projects/ruly/rules/workaxle/profiles/migration.md
      - /Users/patrick/Projects/ruly/rules/workaxle/core/migrations/

  grpc:
    description: "WorkAxle gRPC service development"
    files:
      - /Users/patrick/Projects/ruly/rules/workaxle/core.md
      - /Users/patrick/Projects/ruly/rules/workaxle/profiles/grpc.md
      - /Users/patrick/Projects/ruly/rules/workaxle/core/services/grpc/
      - /Users/patrick/Projects/ruly/rules/bug/commands/grpc.md
      - /Users/patrick/Projects/ruly/rules/github/pr/commands/create.md
      - /Users/patrick/Projects/ruly/rules/github/pr/commands/squash-and-merge.md
      - /Users/patrick/Projects/ruly/rules/github/pr/commands/merge-to-develop.md
      - /Users/patrick/Projects/ruly/rules/github/pr/commands/merge-main-to-develop.md
      - /Users/patrick/Projects/ruly/rules/comms/github/pr/commands/request-review.md
      - /Users/patrick/Projects/ruly/rules/github/pr/commands/review-feedback-loop.md
      - /Users/patrick/Projects/ruly/rules/comms/jira/commands/ready-for-qa.md
    mcp_servers:
      - Ref # For API documentation lookup

  pr:
    description: "WorkAxle PR creation and management"
    files:
      - /Users/patrick/Projects/ruly/rules/workaxle/core.md
      - /Users/patrick/Projects/ruly/rules/github/pr/
      - /Users/patrick/Projects/ruly/rules/github/pr/commands/review-feedback-loop.md

  feature:
    description: "WorkAxle feature development subagent - TDD, full standards, testing, and migrations"
    files:
      # === Superpowers: TDD & Verification (core tenets) ===
      - /Users/patrick/Projects/ruly/superpowers/skills/test-driven-development/SKILL.md
      - /Users/patrick/Projects/ruly/superpowers/skills/test-driven-development/testing-anti-patterns.md
      - /Users/patrick/Projects/ruly/superpowers/skills/verification-before-completion/SKILL.md
      # === WorkAxle Core ===
      - /Users/patrick/Projects/ruly/rules/workaxle/core.md
      # === Essential (ALL — features need feature-flags and outbox) ===
      - /Users/patrick/Projects/ruly/rules/workaxle/core/essential/common.md
      - /Users/patrick/Projects/ruly/rules/workaxle/core/essential/development-commands.md
      - /Users/patrick/Projects/ruly/rules/workaxle/core/essential/feature-flags.md
      - /Users/patrick/Projects/ruly/rules/workaxle/core/essential/outbox.md
      - /Users/patrick/Projects/ruly/rules/workaxle/core/essential/sequel-patterns.md
      - /Users/patrick/Projects/ruly/rules/workaxle/core/essential/soft-delete-pattern.md
      # === Frameworks ===
      - /Users/patrick/Projects/ruly/rules/workaxle/core/frameworks/sequel.md
      - /Users/patrick/Projects/ruly/rules/workaxle/core/frameworks/monads.md
      - /Users/patrick/Projects/ruly/rules/workaxle/core/frameworks/ruby-practices.md
      # === Framework Standards ===
      - /Users/patrick/Projects/ruly/rules/workaxle/core/frameworks/standards/_common-ruby-language-patterns.md
      - /Users/patrick/Projects/ruly/rules/workaxle/core/frameworks/standards/code-style-guidelines.md
      - /Users/patrick/Projects/ruly/rules/workaxle/core/frameworks/standards/constants-configuration.md
      - /Users/patrick/Projects/ruly/rules/workaxle/core/frameworks/standards/duck-typing-polymorphism.md
      - /Users/patrick/Projects/ruly/rules/workaxle/core/frameworks/standards/error-handling.md
      - /Users/patrick/Projects/ruly/rules/workaxle/core/frameworks/standards/guard-clauses-early-returns.md
      - /Users/patrick/Projects/ruly/rules/workaxle/core/frameworks/standards/instance-variables-memoization.md
      - /Users/patrick/Projects/ruly/rules/workaxle/core/frameworks/standards/iteration-enumeration.md
      - /Users/patrick/Projects/ruly/rules/workaxle/core/frameworks/standards/method-chaining-fluent-interfaces.md
      - /Users/patrick/Projects/ruly/rules/workaxle/core/frameworks/standards/module-composition.md
      - /Users/patrick/Projects/ruly/rules/workaxle/core/frameworks/standards/ruby-3-features.md
      # === Testing (RSpec) ===
      - /Users/patrick/Projects/ruly/rules/workaxle/core/testing/rspec-reference.md
      - /Users/patrick/Projects/ruly/rules/workaxle/core/testing/rspec-patterns.md
      - /Users/patrick/Projects/ruly/rules/workaxle/core/testing/rspec-sequel.md
      - /Users/patrick/Projects/ruly/rules/workaxle/core/testing/materialized-views-and-test-isolation.md
      - /Users/patrick/Projects/ruly/rules/workaxle/core/testing/specs.md
      # === Standards ===
      - /Users/patrick/Projects/ruly/rules/workaxle/core/standards/architecture-patterns.md
      - /Users/patrick/Projects/ruly/rules/workaxle/core/standards/code-patterns.md
      - /Users/patrick/Projects/ruly/rules/workaxle/core/standards/runtime-concerns.md
      # === Migrations ===
      - /Users/patrick/Projects/ruly/rules/workaxle/core/migrations/database-migration-patterns.md
      - /Users/patrick/Projects/ruly/rules/workaxle/core/migrations/migration-safety.md
      - /Users/patrick/Projects/ruly/rules/workaxle/core/migrations/schema-vs-data-migrations.md
    mcp_servers:
      - Ref
    subagents:
      - name: core_debugging
        recipe: core-debugging

  auth0:
    description: "WorkAxle Auth0 password and session management development"
    files:
      - /Users/patrick/Projects/ruly/rules/workaxle/core.md
      - /Users/patrick/Projects/ruly/rules/workaxle/core/essential/
      - /Users/patrick/Projects/ruly/rules/workaxle/core/standards/code-patterns.md
      - /Users/patrick/Projects/ruly/rules/workaxle/core/standards/architecture-patterns.md
      - /Users/patrick/Projects/ruly/rules/workaxle/core/frameworks/sequel.md
      - /Users/patrick/Projects/ruly/rules/workaxle/core/frameworks/monads.md
      - /Users/patrick/Projects/ruly/rules/workaxle/core/testing/
      # Auth0 specific
      - /Users/patrick/Projects/ruly/rules/auth0-password-session-management.md
      # Context fetching via subagent (MUST be always loaded)
      - /Users/patrick/Projects/ruly/rules/comms/use-context-fetcher.md
      - /Users/patrick/Projects/ruly/rules/comms/commands/refresh-context.md
      # PR operations
      - /Users/patrick/Projects/ruly/rules/github/pr/commands/create.md
      - /Users/patrick/Projects/ruly/rules/github/pr/commands/create-develop.md
      - /Users/patrick/Projects/ruly/rules/github/pr/commands/create-dual.md
      - /Users/patrick/Projects/ruly/rules/github/pr/commands/review-feedback-loop.md
      - /Users/patrick/Projects/ruly/rules/github/pr/commands/verify-develop-mergability.md
    mcp_servers:
      - Ref # For documentation lookup

    subagents:
      - name: context_fetcher
        recipe: context-fetcher

  refactor:
    description: "WorkAxle code refactoring"
    files:
      - /Users/patrick/Projects/ruly/rules/workaxle/core.md
      - /Users/patrick/Projects/ruly/rules/workaxle/core/standards/
      - /Users/patrick/Projects/ruly/rules/workaxle/core/frameworks/ruby-practices.md
      - /Users/patrick/Projects/ruly/rules/github/pr/commands/create.md
      - /Users/patrick/Projects/ruly/rules/github/pr/commands/squash-and-merge.md
      - /Users/patrick/Projects/ruly/rules/github/pr/commands/merge-to-develop.md
      - /Users/patrick/Projects/ruly/rules/github/pr/commands/merge-main-to-develop.md
      - /Users/patrick/Projects/ruly/rules/comms/github/pr/commands/request-review.md
      - /Users/patrick/Projects/ruly/rules/github/pr/commands/review-feedback-loop.md
      - /Users/patrick/Projects/ruly/rules/comms/jira/commands/ready-for-qa.md

  full:
    description: "Complete WorkAxle documentation"
    files:
      - /Users/patrick/Projects/ruly/rules/workaxle/core.md
      - /Users/patrick/Projects/ruly/rules/workaxle/commands.md
      - /Users/patrick/Projects/ruly/rules/workaxle/permit-io-schema.md
      - /Users/patrick/Projects/ruly/rules/workaxle/core/
      - /Users/patrick/Projects/ruly/rules/bug/
      - /Users/patrick/Projects/ruly/rules/github/pr/
      - /Users/patrick/Projects/ruly/rules/comms/jira/
      - /Users/patrick/Projects/ruly/rules/comms/atlassian-common.md
      - /Users/patrick/Projects/ruly/rules/comms/accounts.md
      - /Users/patrick/Projects/ruly/rules/comms/adf-formatting.md
      - /Users/patrick/Projects/ruly/rules/comms/ms-teams/
      - /Users/patrick/Projects/ruly/rules/comms/mattermost/
      - /Users/patrick/Projects/ruly/rules/workaxle/commands/
      - /Users/patrick/Projects/ruly/rules/workaxle/profiles/
      - /Users/patrick/Projects/ruly/rules/workaxle/archive/
      - /Users/patrick/Projects/ruly/rules/workaxle/user-svc/
      - /Users/patrick/Projects/ruly/rules/workaxle/orchestrator/
    mcp_servers:
      - teams # MS Teams integration
      - mattermost # Mattermost integration
      - playwright # UI testing
      - Ref # Documentation lookup

    subagents:
      - name: ms_teams_dm
        recipe: ms-teams-dm
      - name: mattermost_dm
        recipe: mattermost-dm
      - name: jira_comment
        recipe: jira-comment
      - name: jira_bug_report
        recipe: jira-bug-report
      - name: jira_epic
        recipe: jira-epic
      - name: jira_initiative
        recipe: jira-initiative
      - name: jira_story
        recipe: jira-story
      - name: jira_ready_for_qa
        recipe: jira-ready-for-qa

  finalize:
    description: "WorkAxle final testing and cleanup phase"
    files:
      - /Users/patrick/Projects/ruly/rules/workaxle/core.md
      - /Users/patrick/Projects/ruly/rules/workaxle/core/testing/
      - /Users/patrick/Projects/ruly/rules/workaxle/core/testing/rspec-reference.md
      - /Users/patrick/Projects/ruly/rules/workaxle/core/testing/rspec-sequel.md
      - /Users/patrick/Projects/ruly/rules/bug/rspec-debugging-guide.md
      - /Users/patrick/Projects/ruly/rules/bug/debugging.md
      - /Users/patrick/Projects/ruly/rules/bug/debugging.md
      - /Users/patrick/Projects/ruly/rules/github/pr/commands/make-tests-green.md
      - /Users/patrick/Projects/ruly/rules/github/pr/commands/create.md
      - /Users/patrick/Projects/ruly/rules/github/pr/commands/squash-and-merge.md
      - /Users/patrick/Projects/ruly/rules/github/pr/commands/merge-to-develop.md
      - /Users/patrick/Projects/ruly/rules/github/pr/commands/merge-main-to-develop.md
      - /Users/patrick/Projects/ruly/rules/comms/github/pr/commands/request-review.md
      - /Users/patrick/Projects/ruly/rules/github/pr/commands/review-feedback-loop.md
      - /Users/patrick/Projects/ruly/rules/comms/jira/commands/ready-for-qa.md
    mcp_servers:
      - playwright # For UI/integration testing

  reviewer:
    description: "WorkAxle PR code review — readiness gates, standards enforcement, interactive commenting"
    files:
      # === Reviewing skill ===
      - /Users/patrick/Projects/ruly/rules/github/pr/skills/reviewing-prs.md
      # === Context fetching ===
      - /Users/patrick/Projects/ruly/rules/comms/use-context-fetcher.md
      - /Users/patrick/Projects/ruly/rules/comms/context-fetcher-subagent.md
      # === PR common ===
      - /Users/patrick/Projects/ruly/rules/github/pr/common.md
      # === Jira statuses (for readiness gates) ===
      - /Users/patrick/Projects/ruly/rules/comms/jira/statuses.md
      # === WorkAxle standards (review lens) ===
      - /Users/patrick/Projects/ruly/rules/workaxle/core/standards/code-patterns.md
      - /Users/patrick/Projects/ruly/rules/workaxle/core/standards/architecture-patterns.md
      - /Users/patrick/Projects/ruly/rules/workaxle/core/standards/runtime-concerns.md
      # === WorkAxle frameworks ===
      - /Users/patrick/Projects/ruly/rules/workaxle/core/frameworks/monads.md
      - /Users/patrick/Projects/ruly/rules/workaxle/core/frameworks/ruby-practices.md
      - /Users/patrick/Projects/ruly/rules/workaxle/core/frameworks/sequel.md
      # === WorkAxle Ruby standards ===
      - /Users/patrick/Projects/ruly/rules/workaxle/core/frameworks/standards/code-style-guidelines.md
      - /Users/patrick/Projects/ruly/rules/workaxle/core/frameworks/standards/constants-configuration.md
      - /Users/patrick/Projects/ruly/rules/workaxle/core/frameworks/standards/duck-typing-polymorphism.md
      - /Users/patrick/Projects/ruly/rules/workaxle/core/frameworks/standards/error-handling.md
      - /Users/patrick/Projects/ruly/rules/workaxle/core/frameworks/standards/guard-clauses-early-returns.md
      - /Users/patrick/Projects/ruly/rules/workaxle/core/frameworks/standards/instance-variables-memoization.md
      - /Users/patrick/Projects/ruly/rules/workaxle/core/frameworks/standards/iteration-enumeration.md
      - /Users/patrick/Projects/ruly/rules/workaxle/core/frameworks/standards/method-chaining-fluent-interfaces.md
      - /Users/patrick/Projects/ruly/rules/workaxle/core/frameworks/standards/module-composition.md
      - /Users/patrick/Projects/ruly/rules/workaxle/core/frameworks/standards/ruby-3-features.md
      # === Superpowers code-reviewer ===
      - /Users/patrick/Projects/ruly/superpowers/skills/requesting-code-review/SKILL.md
      - /Users/patrick/Projects/ruly/superpowers/skills/requesting-code-review/code-reviewer.md
    subagents:
      - name: context_fetcher
        recipe: context-fetcher

  jira:
    description: "Jira operations (uses CLI)"
    files:
      - /Users/patrick/Projects/ruly/rules/workaxle/core.md
      - /Users/patrick/Projects/ruly/rules/comms/jira/
      - /Users/patrick/Projects/ruly/rules/comms/atlassian-common.md
      - /Users/patrick/Projects/ruly/rules/comms/accounts.md
      - /Users/patrick/Projects/ruly/rules/comms/adf-formatting.md
      - /Users/patrick/Projects/ruly/rules/comms/ms-teams/commands/dm.md
      - /Users/patrick/Projects/ruly/rules/comms/ms-teams/commands/details.md
      - /Users/patrick/Projects/ruly/rules/comms/mattermost/commands/dm.md
      - /Users/patrick/Projects/ruly/rules/comms/commands/full-context.md
    mcp_servers:
      - teams # For Teams DM notifications
      - mattermost # For Mattermost DM notifications

    subagents:
      - name: ms_teams_dm
        recipe: ms-teams-dm
      - name: mattermost_dm
        recipe: mattermost-dm
      - name: jira_comment
        recipe: jira-comment
      - name: jira_bug_report
        recipe: jira-bug-report
      - name: jira_epic
        recipe: jira-epic
      - name: jira_initiative
        recipe: jira-initiative
      - name: jira_story
        recipe: jira-story
      - name: jira_ready_for_qa
        recipe: jira-ready-for-qa

  confluence:
    description: "WorkAxle Confluence operations (requires atlassian MCP)"
    files:
      - /Users/patrick/Projects/ruly/rules/workaxle/core.md
      - /Users/patrick/Projects/ruly/rules/comms/confluence/
      - /Users/patrick/Projects/ruly/rules/comms/accounts.md
    mcp_servers:
      - atlassian # Required for Confluence page creation

  orchestrator:
    description: "WorkAxle multi-service development and E2E testing"
    files:
      - /Users/patrick/Projects/ruly/rules/workaxle/core.md
      - /Users/patrick/Projects/ruly/rules/workaxle/orchestrator/
      - /Users/patrick/Projects/ruly/rules/github/pr/commands/create.md
      - /Users/patrick/Projects/ruly/rules/skills/deploy-to-production.md
    mcp_servers:
      - playwright # For E2E testing
      - Ref # For documentation lookup

    subagents:
      - name: code_core
        recipe: core

  gateway:
    description: "WorkAxle Gateway NestJS/TypeScript development with orchestrator patterns"
    files:
      - /Users/patrick/Projects/ruly/rules/workaxle/core.md
      - /Users/patrick/Projects/ruly/rules/workaxle/orchestrator/
      - /Users/patrick/Projects/ruly/rules/workaxle/gateway/
      - /Users/patrick/Projects/ruly/rules/github/pr/commands/create.md
      - /Users/patrick/Projects/ruly/rules/github/pr/commands/squash-and-merge.md
      - /Users/patrick/Projects/ruly/rules/github/pr/commands/merge-to-develop.md
      - /Users/patrick/Projects/ruly/rules/github/pr/commands/merge-main-to-develop.md
      - /Users/patrick/Projects/ruly/rules/comms/github/pr/commands/request-review.md
      - /Users/patrick/Projects/ruly/rules/github/pr/commands/review-feedback-loop.md
      - /Users/patrick/Projects/ruly/rules/comms/jira/commands/ready-for-qa.md
    mcp_servers:
      - playwright # For E2E testing
      - Ref # For documentation lookup

  playwright:
    description: "WorkAxle Playwright E2E testing and browser automation"
    files:
      - /Users/patrick/Projects/ruly/rules/workaxle/core.md
      - /Users/patrick/Projects/ruly/rules/workaxle/orchestrator/playwright.md
      - /Users/patrick/Projects/ruly/rules/workaxle/orchestrator/e2e-testing-multi-service.md
      - /Users/patrick/Projects/ruly/rules/workaxle/orchestrator/workaxle-e2e-feature-implementation.md
      - /Users/patrick/Projects/ruly/rules/workaxle/core/testing/
      - /Users/patrick/Projects/ruly/rules/comms/jira/
    mcp_servers:
      - playwright # For browser automation and E2E testing

  spike:
    description: "WorkAxle spike investigation and research for Jira tasks"
    files:
      - /Users/patrick/Projects/ruly/rules/workaxle/core.md
      - /Users/patrick/Projects/ruly/rules/workaxle/profiles/bug-investigation.md
      - /Users/patrick/Projects/ruly/rules/workaxle/core/standards/architecture-patterns.md
      - /Users/patrick/Projects/ruly/rules/workaxle/core/standards/code-patterns.md
      - /Users/patrick/Projects/ruly/rules/workaxle/core/reference/
      - /Users/patrick/Projects/ruly/rules/bug/debugging.md
      - /Users/patrick/Projects/ruly/rules/bug/debugging.md
      - /Users/patrick/Projects/ruly/rules/bug/skills/debugging.md
      - /Users/patrick/Projects/ruly/rules/workaxle/orchestrator/
      - /Users/patrick/Projects/ruly/rules/comms/
      - /Users/patrick/Projects/ruly/rules/bug/commands/diagnose.md
    mcp_servers:
      - atlassian # For Confluence page creation only (Jira uses CLI)
      - Ref # For documentation lookup and external research

  initiative-core:
    description: "WorkAxle initiative investigation and planning"
    files:
      - /Users/patrick/Projects/ruly/rules/workaxle/core.md
      - /Users/patrick/Projects/ruly/rules/workaxle/core/standards/architecture-patterns.md
      - /Users/patrick/Projects/ruly/rules/workaxle/core/standards/code-patterns.md
      - /Users/patrick/Projects/ruly/rules/workaxle/core/reference/
      - /Users/patrick/Projects/ruly/rules/comms/jira/
      - /Users/patrick/Projects/ruly/rules/comms/atlassian-common.md
      - /Users/patrick/Projects/ruly/rules/comms/accounts.md
    mcp_servers:
      - Ref # For documentation lookup and external research

  agile:
    description: "WorkAxle agile planning — epics, stories, initiatives, change proposals, spikes"
    files:
      # === WorkAxle Core ===
      - /Users/patrick/Projects/ruly/rules/workaxle/core.md
      - /Users/patrick/Projects/ruly/rules/workaxle/core/standards/architecture-patterns.md
      - /Users/patrick/Projects/ruly/rules/workaxle/core/standards/code-patterns.md
      # === Reference ===
      - /Users/patrick/Projects/ruly/rules/workaxle/core/reference/service-overview.md
      - /Users/patrick/Projects/ruly/rules/workaxle/core/reference/technology-stack.md
      # === Orchestrator (multi-service patterns) ===
      - /Users/patrick/Projects/ruly/rules/workaxle/orchestrator/common.md
      - /Users/patrick/Projects/ruly/rules/workaxle/orchestrator/structure.md
      - /Users/patrick/Projects/ruly/rules/workaxle/orchestrator/multi-service-development.md
      - /Users/patrick/Projects/ruly/rules/workaxle/orchestrator/multiple.md
      - /Users/patrick/Projects/ruly/rules/workaxle/orchestrator/commands/spike.md
      # === Shared Communication Files ===
      - /Users/patrick/Projects/ruly/rules/comms/accounts.md
      - /Users/patrick/Projects/ruly/rules/comms/adf-formatting.md
      - /Users/patrick/Projects/ruly/rules/comms/atlassian-common.md
      - /Users/patrick/Projects/ruly/rules/comms/jira/preview-common.md
      - /Users/patrick/Projects/ruly/rules/comms/jira/statuses.md
      # === Jira Ticket Creation ===
      - /Users/patrick/Projects/ruly/rules/comms/jira/commands/epic.md
      - /Users/patrick/Projects/ruly/rules/comms/jira/commands/story.md
      - /Users/patrick/Projects/ruly/rules/comms/jira/commands/initiative.md
      # === Confluence ===
      - /Users/patrick/Projects/ruly/rules/comms/confluence/commands/change-proposals.md
      - /Users/patrick/Projects/ruly/rules/comms/confluence/commands/how-to.md
      # === Communication Commands (DMs, commenting) ===
      - /Users/patrick/Projects/ruly/rules/comms/jira/commands/comment.md
      - /Users/patrick/Projects/ruly/rules/comms/jira/commands/ready-for-qa.md
      - /Users/patrick/Projects/ruly/rules/comms/ms-teams/common.md
      - /Users/patrick/Projects/ruly/rules/comms/ms-teams/commands/dm.md
      - /Users/patrick/Projects/ruly/rules/comms/ms-teams/commands/details.md
      - /Users/patrick/Projects/ruly/rules/comms/mattermost/common.md
      - /Users/patrick/Projects/ruly/rules/comms/mattermost/commands/dm.md
      - /Users/patrick/Projects/ruly/rules/comms/commands/full-context.md
    mcp_servers:
      - atlassian # For Confluence page creation and Jira epic/story/initiative creation
      - teams # For Teams DM notifications
      - mattermost # For Mattermost DM notifications
      - Ref # For documentation lookup and external research
    subagents:
      - name: ms_teams_dm
        recipe: ms-teams-dm
      - name: mattermost_dm
        recipe: mattermost-dm
      - name: jira_comment
        recipe: jira-comment
      - name: jira_bug_report
        recipe: jira-bug-report
      - name: jira_epic
        recipe: jira-epic
      - name: jira_initiative
        recipe: jira-initiative
      - name: jira_story
        recipe: jira-story
      - name: jira_ready_for_qa
        recipe: jira-ready-for-qa

  local:
    description: "Local development with all MCP servers, no rule files"
    files:
      - /Users/patrick/Projects/ruly/rules/home/
      - /Users/patrick/Projects/ruly/rules/llmux-tools-setup.md
    mcp_servers:
      - playwright # Browser automation and UI testing
      - Ref # Documentation reference lookup

  awesomer:
    description: "Local development with Plane and GitHub integration (no Playwright)"
    files:
      - /Users/patrick/Projects/ruly/rules/awesomer
      - /Users/patrick/Projects/ruly/rules/home/network-structure.md
      - /Users/patrick/Projects/ruly/rules/workaxle/core/frameworks/monads.md
      - /Users/patrick/Projects/ruly/rules/workaxle/core/frameworks/ruby-practices.md
      - /Users/patrick/Projects/ruly/rules/workaxle/core/standards/code-patterns.md
      - /Users/patrick/Projects/ruly/rules/home/plane-synology-setup.md
    mcp_servers:
      - playwright # Browser automation and UI testing
      - plane # Plane project management
      - Ref # Documentation reference lookup

  merger:
    description: "PR merging commands only (no code knowledge needed)"
    files:
      - /Users/patrick/Projects/ruly/rules/workaxle/core.md
      # PR details and merging
      - /Users/patrick/Projects/ruly/rules/skills/deploy-to-production.md
      - /Users/patrick/Projects/ruly/rules/github/pr/commands/squash-and-merge.md
      - /Users/patrick/Projects/ruly/rules/github/pr/commands/merge-to-develop.md
      - /Users/patrick/Projects/ruly/rules/github/pr/commands/merge-main-to-develop.md
      - /Users/patrick/Projects/ruly/rules/github/pr/commands/update-branches.md
      - /Users/patrick/Projects/ruly/rules/github/pr/commands/verify-develop-mergability.md
      - /Users/patrick/Projects/ruly/rules/github/pr/common.md
      - /Users/patrick/Projects/ruly/rules/github/pr/merge-common.md
      - /Users/patrick/Projects/ruly/rules/git/skills/rebase-and-squash.md

  comms:
    description: "Communication via Jira, Teams, Mattermost, and GitHub — commenting, DMs, reviews, bug reports"
    files:
      # === WorkAxle Context ===
      - /Users/patrick/Projects/ruly/rules/workaxle/core.md
      # === Shared Communication Files ===
      - /Users/patrick/Projects/ruly/rules/comms/accounts.md
      - /Users/patrick/Projects/ruly/rules/comms/adf-formatting.md
      - /Users/patrick/Projects/ruly/rules/comms/atlassian-common.md
      - /Users/patrick/Projects/ruly/rules/comms/ticket-summary-template.md
      # === Jira Communication ===
      - /Users/patrick/Projects/ruly/rules/comms/jira/preview-common.md
      - /Users/patrick/Projects/ruly/rules/comms/jira/statuses.md
      - /Users/patrick/Projects/ruly/rules/comms/jira/workflow.md
      - /Users/patrick/Projects/ruly/rules/comms/jira/filters.md
      - /Users/patrick/Projects/ruly/rules/comms/jira/commands/comment.md
      - /Users/patrick/Projects/ruly/rules/comms/jira/commands/ready-for-qa.md
      - /Users/patrick/Projects/ruly/rules/comms/jira/commands/bug-report.md
      # === MS Teams Communication ===
      - /Users/patrick/Projects/ruly/rules/comms/ms-teams/common.md
      - /Users/patrick/Projects/ruly/rules/comms/ms-teams/commands/dm.md
      - /Users/patrick/Projects/ruly/rules/comms/ms-teams/commands/details.md
      # === Mattermost Communication ===
      - /Users/patrick/Projects/ruly/rules/comms/mattermost/common.md
      - /Users/patrick/Projects/ruly/rules/comms/mattermost/commands/dm.md
      # === GitHub PR Communication ===
      - /Users/patrick/Projects/ruly/rules/comms/github/pr/commands/request-review.md
      - /Users/patrick/Projects/ruly/rules/comms/github/pr/commands/resolve-outdated-comments.md
      - /Users/patrick/Projects/ruly/rules/comms/github/pr/pr-comment-resolution.md
      - /Users/patrick/Projects/ruly/rules/github/pr/common.md
      # === Context (for review requests that need PR context) ===
      - /Users/patrick/Projects/ruly/rules/comms/commands/full-context.md
    mcp_servers:
      - teams # For Teams DM and channel notifications
      - mattermost # For Mattermost DM notifications
    subagents:
      - name: ms_teams_dm
        recipe: ms-teams-dm
      - name: mattermost_dm
        recipe: mattermost-dm
      - name: jira_comment
        recipe: jira-comment
      - name: jira_bug_report
        recipe: jira-bug-report
      - name: jira_ready_for_qa
        recipe: jira-ready-for-qa

  dashboard:
    description: "Open PRs dashboard with context fetching via subagent"
    files:
      - /Users/patrick/Projects/ruly/rules/comms/commands/dashboard.md
      - /Users/patrick/Projects/ruly/rules/github/pr/merge-common.md
      # MUST include the rule that enforces subagent usage
      - /Users/patrick/Projects/ruly/rules/comms/use-context-fetcher.md
    subagents:
      - name: context_fetcher
        recipe: context-fetcher

  architect:
    description: "Read-only architecture advisor — explores codebase, asks questions, produces design plans"
    files:
      - /Users/patrick/Projects/ruly/rules/workaxle/skills/architect.md
      - /Users/patrick/Projects/ruly/rules/workaxle/core.md
      # === Essential (patterns the architect needs to know) ===
      - /Users/patrick/Projects/ruly/rules/workaxle/core/essential/common.md
      - /Users/patrick/Projects/ruly/rules/workaxle/core/essential/feature-flags.md
      - /Users/patrick/Projects/ruly/rules/workaxle/core/essential/outbox.md
      - /Users/patrick/Projects/ruly/rules/workaxle/core/essential/sequel-patterns.md
      - /Users/patrick/Projects/ruly/rules/workaxle/core/essential/soft-delete-pattern.md
      # === Standards (architecture and code conventions) ===
      - /Users/patrick/Projects/ruly/rules/workaxle/core/standards/architecture-patterns.md
      - /Users/patrick/Projects/ruly/rules/workaxle/core/standards/code-patterns.md
      # === Reference (service landscape) ===
      - /Users/patrick/Projects/ruly/rules/workaxle/core/reference/service-overview.md
      - /Users/patrick/Projects/ruly/rules/workaxle/core/reference/technology-stack.md
      # === Frameworks (language and ORM patterns) ===
      - /Users/patrick/Projects/ruly/rules/workaxle/core/frameworks/sequel.md
      - /Users/patrick/Projects/ruly/rules/workaxle/core/frameworks/monads.md
      - /Users/patrick/Projects/ruly/rules/workaxle/core/frameworks/ruby-practices.md
      # === Framework Standards (coding conventions) ===
      - /Users/patrick/Projects/ruly/rules/workaxle/core/frameworks/standards/_common-ruby-language-patterns.md
      - /Users/patrick/Projects/ruly/rules/workaxle/core/frameworks/standards/code-style-guidelines.md
      - /Users/patrick/Projects/ruly/rules/workaxle/core/frameworks/standards/duck-typing-polymorphism.md
      - /Users/patrick/Projects/ruly/rules/workaxle/core/frameworks/standards/error-handling.md
      - /Users/patrick/Projects/ruly/rules/workaxle/core/frameworks/standards/module-composition.md
      # === Migrations (knows when migrations are needed) ===
      - /Users/patrick/Projects/ruly/rules/workaxle/core/migrations/database-migration-patterns.md
      - /Users/patrick/Projects/ruly/rules/workaxle/core/migrations/schema-vs-data-migrations.md

  pr-readiness:
    description: "Verify PR readiness against definition of done (subagent execution)"
    files:
      - /Users/patrick/Projects/ruly/rules/github/pr/skills/verify-pr-readiness.md
      - /Users/patrick/Projects/ruly/rules/github/pr/common.md
      - /Users/patrick/Projects/ruly/rules/comms/use-context-fetcher.md
      - /Users/patrick/Projects/ruly/rules/comms/jira/statuses.md
    subagents:
      - name: context_fetcher
        recipe: context-fetcher

  context-fetcher:
    description: "Fetch and cache Jira/PR/Teams context for a ticket"
    files:
      # CRITICAL: This file tells the subagent what to DO when dispatched
      - /Users/patrick/Projects/ruly/rules/comms/context-fetcher-subagent.md
      - /Users/patrick/Projects/ruly/rules/comms/commands/context-fetching.md
      - /Users/patrick/Projects/ruly/rules/comms/jira/fetching-jira-details.md
    mcp_servers:
      - teams  # For fetching Teams threads

  ms-teams-dm:
    description: "Send a Teams DM (subagent execution)"
    files:
      # CRITICAL: This file tells the subagent what to DO when dispatched
      - /Users/patrick/Projects/ruly/rules/comms/ms-teams/agents/ms-teams-dm.md
      - /Users/patrick/Projects/ruly/rules/comms/ms-teams/common.md
      - /Users/patrick/Projects/ruly/rules/comms/accounts.md
    mcp_servers:
      - teams  # For Teams MCP calls

  mattermost-dm:
    description: "Send a Mattermost DM (subagent execution)"
    files:
      # CRITICAL: This file tells the subagent what to DO when dispatched
      - /Users/patrick/Projects/ruly/rules/comms/mattermost/agents/mattermost-dm.md
      - /Users/patrick/Projects/ruly/rules/comms/mattermost/common.md
      - /Users/patrick/Projects/ruly/rules/comms/accounts.md
    mcp_servers:
      - mattermost  # For Mattermost MCP calls

  jira-comment:
    description: "Post a Jira comment (subagent execution)"
    files:
      - /Users/patrick/Projects/ruly/rules/comms/jira/agents/jira-comment.md
      - /Users/patrick/Projects/ruly/rules/comms/accounts.md

  jira-bug-report:
    description: "Create a Jira bug report (subagent execution)"
    files:
      - /Users/patrick/Projects/ruly/rules/comms/jira/agents/jira-bug-report.md
      - /Users/patrick/Projects/ruly/rules/comms/accounts.md

  jira-epic:
    description: "Create a Jira epic (subagent execution)"
    files:
      - /Users/patrick/Projects/ruly/rules/comms/jira/agents/jira-epic.md
      - /Users/patrick/Projects/ruly/rules/comms/accounts.md
    mcp_servers:
      - atlassian  # Uses Atlassian MCP for issue creation

  jira-initiative:
    description: "Create a Jira initiative (subagent execution)"
    files:
      - /Users/patrick/Projects/ruly/rules/comms/jira/agents/jira-initiative.md
      - /Users/patrick/Projects/ruly/rules/comms/accounts.md
    mcp_servers:
      - atlassian  # Uses Atlassian MCP for issue creation

  jira-story:
    description: "Create a Jira story (subagent execution)"
    files:
      - /Users/patrick/Projects/ruly/rules/comms/jira/agents/jira-story.md
      - /Users/patrick/Projects/ruly/rules/comms/accounts.md
    mcp_servers:
      - atlassian  # Uses Atlassian MCP for issue creation

  jira-ready-for-qa:
    description: "Notify QA - comment, transition, and Teams DM (subagent execution)"
    files:
      - /Users/patrick/Projects/ruly/rules/comms/jira/agents/jira-ready-for-qa.md
      - /Users/patrick/Projects/ruly/rules/comms/accounts.md
      - /Users/patrick/Projects/ruly/rules/comms/ms-teams/common.md
    mcp_servers:
      - teams  # Uses Teams MCP for DM

  core-debugging:
    description: "WorkAxle debugging subagent - SQL, Ruby, container, and test debugging patterns"
    files:
      # === Extracted debugging patterns ===
      - /Users/patrick/Projects/ruly/rules/workaxle/core/debugging.md
      # === Existing bug debugging files ===
      - /Users/patrick/Projects/ruly/rules/bug/debugging.md
      - /Users/patrick/Projects/ruly/rules/bug/skills/debugging.md
      - /Users/patrick/Projects/ruly/rules/bug/rspec-debugging-guide.md
      - /Users/patrick/Projects/ruly/rules/bug/policies.md
      - /Users/patrick/Projects/ruly/rules/bug/commands/grpc.md
      # === WorkAxle context (minimal for reading code) ===
      - /Users/patrick/Projects/ruly/rules/workaxle/core.md
      - /Users/patrick/Projects/ruly/rules/workaxle/core/essential/common.md
      - /Users/patrick/Projects/ruly/rules/workaxle/core/essential/development-commands.md

  bug-diagnose:
    description: "Read-only bug investigation subagent - systematic root cause analysis without fixes"
    files:
      # === Superpowers: Systematic Debugging (core tenet) ===
      - /Users/patrick/Projects/ruly/superpowers/skills/systematic-debugging/SKILL.md
      - /Users/patrick/Projects/ruly/superpowers/skills/systematic-debugging/root-cause-tracing.md
      - /Users/patrick/Projects/ruly/superpowers/skills/systematic-debugging/defense-in-depth.md
      - /Users/patrick/Projects/ruly/superpowers/skills/systematic-debugging/condition-based-waiting.md
      - /Users/patrick/Projects/ruly/superpowers/skills/verification-before-completion/SKILL.md
      # === WorkAxle Core (minimal for reading code) ===
      - /Users/patrick/Projects/ruly/rules/workaxle/core.md
      - /Users/patrick/Projects/ruly/rules/workaxle/core/essential/common.md
      - /Users/patrick/Projects/ruly/rules/workaxle/core/essential/development-commands.md
      - /Users/patrick/Projects/ruly/rules/workaxle/core/essential/sequel-patterns.md
      - /Users/patrick/Projects/ruly/rules/workaxle/core/essential/soft-delete-pattern.md
      # === Frameworks (read-only understanding) ===
      - /Users/patrick/Projects/ruly/rules/workaxle/core/frameworks/sequel.md
      - /Users/patrick/Projects/ruly/rules/workaxle/core/frameworks/monads.md
      - /Users/patrick/Projects/ruly/rules/workaxle/core/frameworks/ruby-practices.md
      # === Bug Investigation (diagnostic only) ===
      - /Users/patrick/Projects/ruly/rules/bug/debugging.md
      - /Users/patrick/Projects/ruly/rules/bug/skills/debugging.md
      - /Users/patrick/Projects/ruly/rules/bug/policies.md
      - /Users/patrick/Projects/ruly/rules/bug/rspec-debugging-guide.md
      - /Users/patrick/Projects/ruly/rules/bug/commands/diagnose.md
      - /Users/patrick/Projects/ruly/rules/bug/commands/grpc.md
      # === Architecture (for root cause analysis) ===
      - /Users/patrick/Projects/ruly/rules/workaxle/core/standards/architecture-patterns.md
      - /Users/patrick/Projects/ruly/rules/workaxle/core/standards/code-patterns.md
      - /Users/patrick/Projects/ruly/rules/workaxle/core/reference/service-overview.md
      - /Users/patrick/Projects/ruly/rules/workaxle/core/reference/technology-stack.md
    subagents:
      - name: core_debugging
        recipe: core-debugging

  bug-fix:
    description: "Bug fix subagent - TDD-driven fix implementation after diagnosis is complete"
    files:
      # === Superpowers: TDD & Verification (core tenets) ===
      - /Users/patrick/Projects/ruly/superpowers/skills/test-driven-development/SKILL.md
      - /Users/patrick/Projects/ruly/superpowers/skills/test-driven-development/testing-anti-patterns.md
      - /Users/patrick/Projects/ruly/superpowers/skills/verification-before-completion/SKILL.md
      # === WorkAxle Core ===
      - /Users/patrick/Projects/ruly/rules/workaxle/core.md
      - /Users/patrick/Projects/ruly/rules/workaxle/core/essential/common.md
      - /Users/patrick/Projects/ruly/rules/workaxle/core/essential/development-commands.md
      - /Users/patrick/Projects/ruly/rules/workaxle/core/essential/feature-flags.md
      - /Users/patrick/Projects/ruly/rules/workaxle/core/essential/outbox.md
      - /Users/patrick/Projects/ruly/rules/workaxle/core/essential/sequel-patterns.md
      - /Users/patrick/Projects/ruly/rules/workaxle/core/essential/soft-delete-pattern.md
      # === Frameworks (for writing code) ===
      - /Users/patrick/Projects/ruly/rules/workaxle/core/frameworks/sequel.md
      - /Users/patrick/Projects/ruly/rules/workaxle/core/frameworks/monads.md
      - /Users/patrick/Projects/ruly/rules/workaxle/core/frameworks/ruby-practices.md
      # === RSpec (for writing tests) ===
      - /Users/patrick/Projects/ruly/rules/workaxle/core/testing/rspec-reference.md
      - /Users/patrick/Projects/ruly/rules/workaxle/core/testing/rspec-patterns.md
      - /Users/patrick/Projects/ruly/rules/workaxle/core/testing/rspec-sequel.md
      # === Testing ===
      - /Users/patrick/Projects/ruly/rules/workaxle/core/testing/specs.md
      # === Standards (for writing code) ===
      - /Users/patrick/Projects/ruly/rules/workaxle/core/standards/code-patterns.md
      - /Users/patrick/Projects/ruly/rules/workaxle/core/standards/runtime-concerns.md
      # === Bug Fix Command ===
      - /Users/patrick/Projects/ruly/rules/bug/commands/fix.md
    subagents:
      - name: core_debugging
        recipe: core-debugging
